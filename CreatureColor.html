<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>æ€ªç‰©è‰²å¡ â€” Soft / Moss / Jelly Crystal</title>
  <style>
    :root {
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      --bg-primary: #0f1115;
      --bg-secondary: rgba(255,255,255,0.02);
      --bg-card: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      --border-color: rgba(255,255,255,0.04);
      --text-primary: #e8eefc;
      --text-secondary: #cbd7ff;
      --text-tertiary: #bfcffb;
      --button-bg: #21242b;
      --button-hover: #2a2d35;
      --accent: #6366f1;
      --success: #10b981;
      --shadow: 0 6px 18px rgba(2,6,23,0.6);
      --shadow-hover: 0 12px 24px rgba(2,6,23,0.8);
      transition: all 0.3s ease;
    }

    [data-theme="light"] {
      --bg-primary: #f8fafc;
      --bg-secondary: rgba(0,0,0,0.02);
      --bg-card: linear-gradient(180deg, rgba(0,0,0,0.02), rgba(0,0,0,0.01));
      --border-color: rgba(0,0,0,0.08);
      --text-primary: #1e293b;
      --text-secondary: #475569;
      --text-tertiary: #64748b;
      --button-bg: #e2e8f0;
      --button-hover: #cbd5e1;
      --shadow: 0 6px 18px rgba(0,0,0,0.1);
      --shadow-hover: 0 12px 24px rgba(0,0,0,0.15);
    }

    * {
      box-sizing: border-box;
    }

    body {
      background: var(--bg-primary);
      color: var(--text-primary);
      margin: 0;
      padding: 32px;
      min-height: 100vh;
      transition: background 0.3s ease, color 0.3s ease;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 16px;
    }

    h1 {
      font-size: 24px;
      margin: 0;
      font-weight: 700;
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .toolbar {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
    }

    .search-box {
      position: relative;
    }

    .search-input {
      background: var(--button-bg);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      padding: 10px 16px 10px 40px;
      border-radius: 8px;
      font-size: 14px;
      width: 250px;
      transition: all 0.2s ease;
    }

    .search-input:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }

    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      opacity: 0.5;
      pointer-events: none;
    }

    button {
      background: var(--button-bg);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    button:hover {
      background: var(--button-hover);
      transform: translateY(-1px);
      box-shadow: var(--shadow);
    }

    button:active {
      transform: translateY(0);
    }

    button.primary {
      background: var(--accent);
      border-color: var(--accent);
      color: white;
    }

    button.primary:hover {
      background: #4f46e5;
      border-color: #4f46e5;
    }

    .wrap {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 24px;
    }

    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      padding: 20px;
      border-radius: 16px;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #6366f1, #8b5cf6, #ec4899);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-hover);
      border-color: rgba(255,255,255,0.1);
    }

    .card:hover::before {
      opacity: 1;
    }

    .card.hidden {
      display: none;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }

    .title {
      font-weight: 700;
      margin-bottom: 8px;
      font-size: 18px;
      line-height: 1.4;
    }

    .desc {
      font-size: 14px;
      margin-bottom: 16px;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    .swatches {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 12px;
      margin-bottom: 16px;
    }

    .swatch {
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--border-color);
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
      background: var(--bg-secondary);
    }

    .swatch:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 10;
    }

    .swatch.expanded {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1.2);
      z-index: 1000;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }

    .chip {
      height: 100px;
      display: flex;
      align-items: flex-end;
      padding: 10px;
      font-weight: 700;
      position: relative;
      transition: all 0.3s ease;
    }

    .chip:hover {
      height: 120px;
    }

    .chip span {
      padding: 6px 10px;
      border-radius: 8px;
      font-size: 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      font-weight: 700;
    }

    .chip span.light-text {
      background: rgba(255,255,255,0.95);
      color: rgba(0,0,0,0.8);
    }

    .chip span.dark-text {
      background: rgba(0,0,0,0.7);
      color: rgba(255,255,255,0.95);
    }

    .meta {
      background: rgba(255,255,255,0.95);
      padding: 10px;
      font-size: 12px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #1e293b;
      backdrop-filter: blur(10px);
    }

    .hex {
      font-family: 'Courier New', monospace;
      font-weight: 700;
      cursor: pointer;
      padding: 4px 8px;
      border-radius: 4px;
      transition: all 0.2s ease;
    }

    .hex:hover {
      background: rgba(99, 102, 241, 0.1);
    }

    .label {
      opacity: 0.8;
      font-weight: 500;
    }

    .color-info {
      display: none;
      padding: 12px;
      background: rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
      border-top: 1px solid var(--border-color);
      font-size: 11px;
      color: var(--text-primary);
    }

    .swatch:hover .color-info {
      display: block;
    }

    .color-info-row {
      display: flex;
      justify-content: space-between;
      margin: 4px 0;
      font-family: monospace;
    }

    .actions {
      margin-top: 16px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .note {
      margin-top: 24px;
      padding: 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
      font-size: 13px;
      color: var(--text-tertiary);
      line-height: 1.6;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      backdrop-filter: blur(8px);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 24px;
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-title {
      font-size: 20px;
      font-weight: 700;
    }

    .close-btn {
      background: transparent;
      border: none;
      font-size: 24px;
      padding: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .color-picker-group {
      margin-bottom: 16px;
    }

    .color-picker-label {
      display: block;
      margin-bottom: 8px;
      font-size: 14px;
      font-weight: 500;
    }

    .color-picker-input {
      width: 100%;
      height: 50px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
    }

    .export-options {
      display: grid;
      gap: 12px;
      margin-top: 20px;
    }

    .export-option {
      padding: 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .export-option:hover {
      background: var(--button-bg);
      border-color: var(--accent);
    }

    .toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--success);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      z-index: 3000;
      opacity: 0;
      transform: translateY(20px);
      transition: all 0.3s ease;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
    }

    .favorite-btn {
      background: transparent;
      border: none;
      padding: 4px;
      cursor: pointer;
      font-size: 20px;
      transition: transform 0.2s ease;
    }

    .favorite-btn:hover {
      transform: scale(1.2);
    }

    .favorite-btn.active {
      color: #fbbf24;
    }

    @media (max-width: 768px) {
      body {
        padding: 16px;
      }

      .header {
        flex-direction: column;
        align-items: flex-start;
      }

      .search-input {
        width: 100%;
      }

      .wrap {
        grid-template-columns: 1fr;
      }

      .swatches {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .stats {
      display: flex;
      gap: 16px;
      margin-top: 24px;
      flex-wrap: wrap;
    }

    .stat-card {
      flex: 1;
      min-width: 150px;
      padding: 16px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 12px;
    }

    .stat-label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 700;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ¨ æ€ªç‰©è‰²å¡ â€” Soft / Moss / Jelly Crystal</h1>
    <div class="toolbar">
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢é¢œè‰²æˆ–æ ‡ç­¾...">
      </div>
      <button onclick="toggleTheme()" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ“</button>
      <button onclick="openExportModal()" class="primary">ğŸ“¥ å¯¼å‡º</button>
      <button onclick="openEditModal()">âœï¸ ç¼–è¾‘</button>
    </div>
  </div>

  <div class="wrap" id="cardContainer">
    <!-- Soft Creature -->
    <div class="card" data-creature="soft" data-tags="æŸ”è½¯ é›¾æ°” æ£‰èŠ± è„†å¼± å®‰é™">
      <div class="card-header">
        <div>
          <div class="title">æ€ªç‰©ä¸€ Â· Soft Creature æ°´æ¯</div>
          <div class="desc">æ°›å›´ï¼šé›¾æ°”ã€è„†å¼±ã€å®‰é™</div>
        </div>
        <button class="favorite-btn" onclick="toggleFavorite('soft')" title="æ”¶è—">â­</button>
      </div>
      <div class="swatches">
        <div class="swatch" data-color="#D8C8D0" data-label="ç²‰ç°" data-role="ä¸»è‰²">
          <div class="chip" style="background:#D8C8D0"><span>ç²‰ç°</span></div>
          <div class="meta">
            <div class="label">ä¸»è‰²</div>
            <div class="hex">#D8C8D0</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#F3EFEA" data-label="å¥¶ç™½" data-role="é«˜å…‰">
          <div class="chip" style="background:#F3EFEA"><span>å¥¶ç™½</span></div>
          <div class="meta">
            <div class="label">é«˜å…‰</div>
            <div class="hex">#F3EFEA</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#C5B4E3" data-label="é›¾ç´«" data-role="çº¹ç†ç»†èŠ‚">
          <div class="chip" style="background:#C5B4E3"><span>é›¾ç´«</span></div>
          <div class="meta">
            <div class="label">çº¹ç†ç»†èŠ‚</div>
            <div class="hex">#C5B4E3</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#B49E89" data-label="æµ…è¤" data-role="è¾¹ç¼˜/å™¨å®˜">
          <div class="chip" style="background:#B49E89"><span>æµ…è¤</span></div>
          <div class="meta">
            <div class="label">è¾¹ç¼˜/å™¨å®˜</div>
            <div class="hex">#B49E89</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#DDE3F2" data-label="æ·¡è“ç°" data-role="çœ¼ç›/åå…‰">
          <div class="chip" style="background:#DDE3F2"><span>æ·¡è“ç°</span></div>
          <div class="meta">
            <div class="label">çœ¼ç›/åå…‰</div>
            <div class="hex">#DDE3F2</div>
          </div>
          <div class="color-info"></div>
        </div>
      </div>
    </div>

    <!-- Moss Creature -->
    <div class="card" data-creature="moss" data-tags="æ£®æ— è—»ç±» æ¸©é¡º å‘†èŒ è‹”ç»¿">
      <div class="card-header">
        <div>
          <div class="title">æ€ªç‰©äºŒ Â· åœ°æ¯ Moss Creature</div>
          <div class="desc">æ°›å›´ï¼šæ¸©é¡ºã€å·¨å¤§ã€ç¼“æ…¢</div>
        </div>
        <button class="favorite-btn" onclick="toggleFavorite('moss')" title="æ”¶è—">â­</button>
      </div>
      <div class="swatches">
        <div class="swatch" data-color="#6F8F63" data-label="è‹”ç»¿è‰²" data-role="ä¸»ä½“">
          <div class="chip" style="background:#6F8F63"><span>è‹”ç»¿è‰²</span></div>
          <div class="meta">
            <div class="label">ä¸»ä½“</div>
            <div class="hex">#6F8F63</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#5A7A75" data-label="æµ·è—»é’" data-role="æ¹¿æ¶¦/çš±è¤¶">
          <div class="chip" style="background:#5A7A75"><span>æµ·è—»é’</span></div>
          <div class="meta">
            <div class="label">æ¹¿æ¶¦/çš±è¤¶</div>
            <div class="hex">#5A7A75</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#8A7E6A" data-label="åœŸç°æ£•" data-role="è§’è´¨ç»“æ„">
          <div class="chip" style="background:#8A7E6A"><span>åœŸç°æ£•</span></div>
          <div class="meta">
            <div class="label">è§’è´¨ç»“æ„</div>
            <div class="hex">#8A7E6A</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#CFE8D4" data-label="æ·¡è–„è·" data-role="å‘å…‰å™¨å®˜">
          <div class="chip" style="background:#CFE8D4"><span>æ·¡è–„è·</span></div>
          <div class="meta">
            <div class="label">å‘å…‰å™¨å®˜</div>
            <div class="hex">#CFE8D4</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#2F3F34" data-label="é˜´å½±å¢¨ç»¿" data-role="æ·±éƒ¨é˜´å½±">
          <div class="chip" style="background:#2F3F34"><span>é˜´å½±å¢¨ç»¿</span></div>
          <div class="meta">
            <div class="label">æ·±éƒ¨é˜´å½±</div>
            <div class="hex">#2F3F34</div>
          </div>
          <div class="color-info"></div>
        </div>
      </div>
    </div>

    <!-- Jelly Crystal -->
    <div class="card" data-creature="jelly" data-tags="æ°´æ¯ æ™¶ä½“ æ·±æµ· å®çŸ³ å¤–æ˜Ÿ å‘å…‰">
      <div class="card-header">
        <div>
          <div class="title">æ€ªç‰©ä¸‰ Â· Crystal Snake</div>
          <div class="desc">æ°›å›´ï¼šé è¿‘ä¼šå‘å…‰ï¼Œè¿…é€Ÿæ¸¸åŠ¨</div>
        </div>
        <button class="favorite-btn" onclick="toggleFavorite('jelly')" title="æ”¶è—">â­</button>
      </div>
      <div class="swatches">
        <div class="swatch" data-color="#A8C8E8" data-label="åŠé€æ˜è“" data-role="çš®è‚¤">
          <div class="chip" style="background:rgba(168,200,232,0.9);backdrop-filter:blur(4px);"><span>åŠé€æ˜è“</span></div>
          <div class="meta">
            <div class="label">çš®è‚¤</div>
            <div class="hex">#A8C8E8</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#E7B7D2" data-label="ç³–æœç²‰" data-role="å†…éƒ¨èƒ½é‡">
          <div class="chip" style="background:#E7B7D2"><span>ç³–æœç²‰</span></div>
          <div class="meta">
            <div class="label">å†…éƒ¨èƒ½é‡</div>
            <div class="hex">#E7B7D2</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#C8D6EE" data-label="æµ…é’ç´«" data-role="è§¦æ‰‹">
          <div class="chip" style="background:#C8D6EE"><span>æµ…é’ç´«</span></div>
          <div class="meta">
            <div class="label">è§¦æ‰‹</div>
            <div class="hex">#C8D6EE</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#F6CBA1" data-label="æš–æ©™å…‰" data-role="å‘å…‰ç»“èŠ‚">
          <div class="chip" style="background:#F6CBA1"><span>æš–æ©™å…‰</span></div>
          <div class="meta">
            <div class="label">å‘å…‰ç»“èŠ‚</div>
            <div class="hex">#F6CBA1</div>
          </div>
          <div class="color-info"></div>
        </div>

        <div class="swatch" data-color="#44496B" data-label="æ·±è“ç´«" data-role="ä½“è…”æ·±å¤„">
          <div class="chip" style="background:#44496B"><span>æ·±è“ç´«</span></div>
          <div class="meta">
            <div class="label">ä½“è…”æ·±å¤„</div>
            <div class="hex">#44496B</div>
          </div>
          <div class="color-info"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="stats">
    <div class="stat-card">
      <div class="stat-label">æ€»é¢œè‰²æ•°</div>
      <div class="stat-value" id="totalColors">15</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">æ”¶è—æ•°</div>
      <div class="stat-value" id="favoriteCount">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">å·²å¤åˆ¶</div>
      <div class="stat-value" id="copiedCount">0</div>
    </div>
  </div>

  <div class="note">
    <strong>ğŸ’¡ ä½¿ç”¨æç¤ºï¼š</strong><br>
    â€¢ ç‚¹å‡»ä»»æ„ <strong>HEX</strong> å€¼ä¼šå¤åˆ¶åˆ°å‰ªè´´æ¿<br>
    â€¢ æ‚¬åœåœ¨è‰²å—ä¸ŠæŸ¥çœ‹è¯¦ç»†é¢œè‰²ä¿¡æ¯ï¼ˆRGBã€HSLã€äº®åº¦ï¼‰<br>
    â€¢ ä½¿ç”¨æœç´¢æ¡†å¿«é€ŸæŸ¥æ‰¾é¢œè‰²æˆ–æ ‡ç­¾<br>
    â€¢ ç‚¹å‡»æ”¶è—æŒ‰é’®ä¿å­˜å–œæ¬¢çš„é…è‰²æ–¹æ¡ˆ<br>
    â€¢ ä½¿ç”¨å¯¼å‡ºåŠŸèƒ½ç”Ÿæˆ PNGã€JSON æˆ– CSS å˜é‡æ–‡ä»¶
  </div>

  <!-- Export Modal -->
  <div class="modal" id="exportModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">å¯¼å‡ºé…è‰²æ–¹æ¡ˆ</div>
        <button class="close-btn" onclick="closeModal('exportModal')">Ã—</button>
      </div>
      <div class="export-options">
        <div class="export-option" onclick="exportAsJSON()">
          <strong>ğŸ“„ JSON æ ¼å¼</strong>
          <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">å¯¼å‡ºä¸º JSON æ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰é¢œè‰²ä¿¡æ¯</div>
        </div>
        <div class="export-option" onclick="exportAsCSS()">
          <strong>ğŸ¨ CSS å˜é‡</strong>
          <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">å¯¼å‡ºä¸º CSS å˜é‡æ–‡ä»¶ï¼Œå¯ç›´æ¥åœ¨é¡¹ç›®ä¸­ä½¿ç”¨</div>
        </div>
        <div class="export-option" onclick="exportAsPNG()">
          <strong>ğŸ–¼ï¸ PNG å›¾ç‰‡</strong>
          <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">å¯¼å‡ºä¸º PNG å›¾ç‰‡ï¼Œé€‚åˆåˆ†äº«å’Œå±•ç¤º</div>
        </div>
        </div>
      </div>
    </div>

  <!-- Edit Modal -->
  <div class="modal" id="editModal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">ç¼–è¾‘é¢œè‰²</div>
        <button class="close-btn" onclick="closeModal('editModal')">Ã—</button>
      </div>
      <div id="editContent">
        <p style="color: var(--text-secondary);">ç‚¹å‡»è‰²å—å¼€å§‹ç¼–è¾‘é¢œè‰²</p>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // ä¸»é¢˜åˆ‡æ¢
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme') || 'dark';
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
    }

    // åŠ è½½ä¿å­˜çš„ä¸»é¢˜
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
      document.documentElement.setAttribute('data-theme', savedTheme);
    }

    // æœç´¢åŠŸèƒ½
    const searchInput = document.getElementById('searchInput');
    searchInput.addEventListener('input', (e) => {
      const query = e.target.value.toLowerCase();
      const cards = document.querySelectorAll('.card');
      cards.forEach(card => {
        const tags = card.getAttribute('data-tags').toLowerCase();
        const title = card.querySelector('.title').textContent.toLowerCase();
        const desc = card.querySelector('.desc').textContent.toLowerCase();
        const colors = Array.from(card.querySelectorAll('.swatch')).map(s => 
          s.getAttribute('data-label').toLowerCase() + ' ' + s.getAttribute('data-color').toLowerCase()
        ).join(' ');
        
        if (tags.includes(query) || title.includes(query) || desc.includes(query) || colors.includes(query)) {
          card.classList.remove('hidden');
        } else {
          card.classList.add('hidden');
        }
      });
    });

    // å¤åˆ¶ HEX å€¼
    let copiedCount = 0;
    document.querySelectorAll('.hex').forEach(el => {
      el.style.cursor = 'pointer';
      el.title = 'ç‚¹å‡»å¤åˆ¶ HEX';
      el.addEventListener('click', () => {
        const hex = el.textContent.replace(' âœ”', '');
        navigator.clipboard.writeText(hex).then(() => {
          el.textContent = hex + ' âœ”';
          setTimeout(() => { el.textContent = hex; }, 800);
          copiedCount++;
          document.getElementById('copiedCount').textContent = copiedCount;
          showToast('å·²å¤åˆ¶ ' + hex);
        });
      });
    });

    // é¢œè‰²ä¿¡æ¯è®¡ç®—å’Œæ˜¾ç¤º
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
      } : null;
    }

    function rgbToHsl(r, g, b) {
      r /= 255;
      g /= 255;
      b /= 255;
      const max = Math.max(r, g, b);
      const min = Math.min(r, g, b);
      let h, s, l = (max + min) / 2;

      if (max === min) {
        h = s = 0;
      } else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
          case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
          case g: h = ((b - r) / d + 2) / 6; break;
          case b: h = ((r - g) / d + 4) / 6; break;
        }
      }
      return {
        h: Math.round(h * 360),
        s: Math.round(s * 100),
        l: Math.round(l * 100)
      };
    }

    function getLuminance(r, g, b) {
      const [rs, gs, bs] = [r, g, b].map(c => {
        c = c / 255;
        return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
      });
      return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
    }

    // æ ¹æ®èƒŒæ™¯è‰²äº®åº¦è‡ªåŠ¨è®¾ç½®æ–‡å­—é¢œè‰²
    function setTextColorForSwatches() {
      document.querySelectorAll('.swatch').forEach(swatch => {
        const hex = swatch.getAttribute('data-color');
        const rgb = hexToRgb(hex);
        if (rgb) {
          const chip = swatch.querySelector('.chip');
          const span = chip.querySelector('span');
          
          // è®¡ç®—ç›¸å¯¹äº®åº¦ï¼ˆ0-1ä¹‹é—´ï¼‰
          const luminance = getLuminance(rgb.r, rgb.g, rgb.b);
          
          // å¦‚æœäº®åº¦å°äº0.5ï¼Œä½¿ç”¨æµ…è‰²æ–‡å­—ï¼›å¦åˆ™ä½¿ç”¨æ·±è‰²æ–‡å­—
          if (luminance < 0.5) {
            span.classList.remove('light-text');
            span.classList.add('dark-text');
          } else {
            span.classList.remove('dark-text');
            span.classList.add('light-text');
          }
        }
      });
    }

    // ä¸ºæ¯ä¸ªè‰²å—æ·»åŠ é¢œè‰²ä¿¡æ¯
    document.querySelectorAll('.swatch').forEach(swatch => {
      const hex = swatch.getAttribute('data-color');
      const rgb = hexToRgb(hex);
      if (rgb) {
        const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
        const luminance = getLuminance(rgb.r, rgb.g, rgb.b);
        const brightness = Math.round(luminance * 100);
        
        const infoDiv = swatch.querySelector('.color-info');
        infoDiv.innerHTML = `
          <div class="color-info-row"><span>RGB:</span><span>${rgb.r}, ${rgb.g}, ${rgb.b}</span></div>
          <div class="color-info-row"><span>HSL:</span><span>${hsl.h}Â°, ${hsl.s}%, ${hsl.l}%</span></div>
          <div class="color-info-row"><span>äº®åº¦:</span><span>${brightness}%</span></div>
        `;
      }

      // åŒå‡»ç¼–è¾‘é¢œè‰²
      swatch.addEventListener('dblclick', () => {
        openColorEditor(swatch);
      });
    });

    // æ”¶è—åŠŸèƒ½
    let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
    
    function toggleFavorite(creature) {
      const index = favorites.indexOf(creature);
      if (index > -1) {
        favorites.splice(index, 1);
      } else {
        favorites.push(creature);
      }
      localStorage.setItem('favorites', JSON.stringify(favorites));
      updateFavoriteButtons();
      updateFavoriteCount();
    }

    function updateFavoriteButtons() {
      document.querySelectorAll('.favorite-btn').forEach(btn => {
        const creature = btn.getAttribute('onclick').match(/'([^']+)'/)[1];
        if (favorites.includes(creature)) {
          btn.classList.add('active');
          btn.textContent = 'â­';
        } else {
          btn.classList.remove('active');
          btn.textContent = 'â˜†';
        }
      });
    }

    function updateFavoriteCount() {
      document.getElementById('favoriteCount').textContent = favorites.length;
    }

    updateFavoriteButtons();
    updateFavoriteCount();

    // æ¨¡æ€æ¡†æ§åˆ¶
    function openModal(id) {
      document.getElementById(id).classList.add('active');
    }

    function closeModal(id) {
      document.getElementById(id).classList.remove('active');
    }

    // ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
    document.querySelectorAll('.modal').forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.remove('active');
        }
      });
    });

    // å¯¼å‡ºåŠŸèƒ½
    function openExportModal() {
      openModal('exportModal');
    }

    function exportAsJSON() {
      const data = {
        version: '1.0',
        exportDate: new Date().toISOString(),
        creatures: []
      };

      document.querySelectorAll('.card').forEach(card => {
        const creature = {
          id: card.getAttribute('data-creature'),
          title: card.querySelector('.title').textContent,
          desc: card.querySelector('.desc').textContent,
          colors: []
        };

        card.querySelectorAll('.swatch').forEach(swatch => {
          creature.colors.push({
            hex: swatch.getAttribute('data-color'),
            label: swatch.getAttribute('data-label'),
            role: swatch.getAttribute('data-role')
          });
        });

        data.creatures.push(creature);
      });

      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'creature-colors.json';
      a.click();
      URL.revokeObjectURL(url);
      closeModal('exportModal');
      showToast('JSON æ–‡ä»¶å·²å¯¼å‡º');
    }

    function exportAsCSS() {
      let css = ':root {\n';
      document.querySelectorAll('.card').forEach(card => {
        const creature = card.getAttribute('data-creature');
        card.querySelectorAll('.swatch').forEach(swatch => {
          const role = swatch.getAttribute('data-role').replace(/\//g, '-').toLowerCase();
          const hex = swatch.getAttribute('data-color');
          css += `  --${creature}-${role}: ${hex};\n`;
        });
      });
      css += '}\n';

      const blob = new Blob([css], { type: 'text/css' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'creature-colors.css';
      a.click();
      URL.revokeObjectURL(url);
      closeModal('exportModal');
      showToast('CSS æ–‡ä»¶å·²å¯¼å‡º');
    }

    function exportAsPNG() {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      const cards = document.querySelectorAll('.card');
      const cardHeight = 200;
      const cardWidth = 800;
      const padding = 20;
      
      canvas.width = cardWidth;
      canvas.height = cards.length * (cardHeight + padding) + padding;

      ctx.fillStyle = getComputedStyle(document.body).backgroundColor;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      let y = padding;
      cards.forEach((card, cardIndex) => {
        const swatches = card.querySelectorAll('.swatch');
        const swatchSize = 80;
        const swatchSpacing = 10;
        let x = padding;

        // ç»˜åˆ¶æ ‡é¢˜
        ctx.fillStyle = getComputedStyle(document.querySelector('.title')).color;
        ctx.font = 'bold 16px Inter';
        ctx.fillText(card.querySelector('.title').textContent, x, y + 20);

        y += 40;
        x = padding;

        swatches.forEach(swatch => {
          const hex = swatch.getAttribute('data-color');
          const rgb = hexToRgb(hex);
          
          // ç»˜åˆ¶è‰²å—
          ctx.fillStyle = hex;
          ctx.fillRect(x, y, swatchSize, swatchSize);
          
          // ç»˜åˆ¶è¾¹æ¡†
          ctx.strokeStyle = 'rgba(0,0,0,0.1)';
          ctx.lineWidth = 1;
          ctx.strokeRect(x, y, swatchSize, swatchSize);

          // ç»˜åˆ¶ HEX å€¼
          ctx.fillStyle = '#000';
          ctx.font = '12px monospace';
          ctx.fillText(hex, x + 5, y + swatchSize - 5);

          x += swatchSize + swatchSpacing;
        });

        y += cardHeight;
      });

      canvas.toBlob(blob => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'creature-colors.png';
        a.click();
        URL.revokeObjectURL(url);
        closeModal('exportModal');
        showToast('PNG å›¾ç‰‡å·²å¯¼å‡º');
      });
    }

    // é¢œè‰²ç¼–è¾‘å™¨
    let currentEditingSwatch = null;

    function openColorEditor(swatch) {
      currentEditingSwatch = swatch;
      const hex = swatch.getAttribute('data-color');
      const label = swatch.getAttribute('data-label');
      const role = swatch.getAttribute('data-role');

      const editContent = document.getElementById('editContent');
      editContent.innerHTML = `
        <div class="color-picker-group">
          <label class="color-picker-label">é¢œè‰²æ ‡ç­¾: ${label}</label>
          <input type="color" class="color-picker-input" value="${hex}" id="colorPicker">
        </div>
        <div class="color-picker-group">
          <label class="color-picker-label">HEX å€¼</label>
          <input type="text" class="search-input" id="hexInput" value="${hex}" style="width: 100%; padding-left: 16px;">
        </div>
        <div style="margin-top: 20px;">
          <button onclick="saveColorEdit()" class="primary" style="width: 100%;">ä¿å­˜æ›´æ”¹</button>
        </div>
      `;

      const colorPicker = document.getElementById('colorPicker');
      const hexInput = document.getElementById('hexInput');

      colorPicker.addEventListener('input', (e) => {
        hexInput.value = e.target.value.toUpperCase();
      });

      hexInput.addEventListener('input', (e) => {
        const value = e.target.value;
        if (/^#[0-9A-Fa-f]{6}$/.test(value)) {
          colorPicker.value = value;
        }
      });

      openModal('editModal');
    }

    function openEditModal() {
      showToast('åŒå‡»ä»»æ„è‰²å—å¼€å§‹ç¼–è¾‘');
    }

    function saveColorEdit() {
      if (!currentEditingSwatch) return;

      const newHex = document.getElementById('hexInput').value.toUpperCase();
      if (!/^#[0-9A-Fa-f]{6}$/.test(newHex)) {
        showToast('æ— æ•ˆçš„ HEX é¢œè‰²å€¼');
        return;
      }

      currentEditingSwatch.setAttribute('data-color', newHex);
      const chip = currentEditingSwatch.querySelector('.chip');
      chip.style.background = newHex;
      const hexEl = currentEditingSwatch.querySelector('.hex');
      hexEl.textContent = newHex;

      // æ›´æ–°é¢œè‰²ä¿¡æ¯
      const rgb = hexToRgb(newHex);
      if (rgb) {
        const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
        const luminance = getLuminance(rgb.r, rgb.g, rgb.b);
        const brightness = Math.round(luminance * 100);
        
        const infoDiv = currentEditingSwatch.querySelector('.color-info');
        infoDiv.innerHTML = `
          <div class="color-info-row"><span>RGB:</span><span>${rgb.r}, ${rgb.g}, ${rgb.b}</span></div>
          <div class="color-info-row"><span>HSL:</span><span>${hsl.h}Â°, ${hsl.s}%, ${hsl.l}%</span></div>
          <div class="color-info-row"><span>äº®åº¦:</span><span>${brightness}%</span></div>
        `;
        
        // æ›´æ–°æ–‡å­—é¢œè‰²
        const span = currentEditingSwatch.querySelector('.chip span');
        if (luminance < 0.5) {
          span.classList.remove('light-text');
          span.classList.add('dark-text');
        } else {
          span.classList.remove('dark-text');
          span.classList.add('light-text');
        }
      }

      closeModal('editModal');
      showToast('é¢œè‰²å·²æ›´æ–°');
      currentEditingSwatch = null;
    }

    // Toast é€šçŸ¥
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, 2000);
    }

    // åˆå§‹åŒ–é¢œè‰²ä¿¡æ¯æ˜¾ç¤º
    document.querySelectorAll('.swatch').forEach(swatch => {
      const hex = swatch.getAttribute('data-color');
      const rgb = hexToRgb(hex);
      if (rgb) {
        const hsl = rgbToHsl(rgb.r, rgb.g, rgb.b);
        const luminance = getLuminance(rgb.r, rgb.g, rgb.b);
        const brightness = Math.round(luminance * 100);
        
        const infoDiv = swatch.querySelector('.color-info');
        infoDiv.innerHTML = `
          <div class="color-info-row"><span>RGB:</span><span>${rgb.r}, ${rgb.g}, ${rgb.b}</span></div>
          <div class="color-info-row"><span>HSL:</span><span>${hsl.h}Â°, ${hsl.s}%, ${hsl.l}%</span></div>
          <div class="color-info-row"><span>äº®åº¦:</span><span>${brightness}%</span></div>
        `;
      }
    });

    // åˆå§‹åŒ–æ–‡å­—é¢œè‰²ï¼ˆæ ¹æ®èƒŒæ™¯è‰²äº®åº¦è‡ªåŠ¨è®¾ç½®ï¼‰
    setTextColorForSwatches();
  </script>
</body>
</html>